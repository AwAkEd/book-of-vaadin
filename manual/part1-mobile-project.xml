<?xml version="1.0" encoding="UTF-8"?>

<section xml:id="mobile.project">
	<title>Creating a Project Targeting Multiple Devices</title>

    <para>
    </para>

    <section xml:id="mobile.project.installing">
        <title>Using TouchKit Add-on in a Project</title>

        <para>
            You can install TouchKit as a Vaadin add-on or use it with Maven with the
            <literal>vaadin-touchkit</literal> dependency.

            <!-- TODO: Reference to the add-on installation. -->
        </para>

        <section xml:id="mobile.project.webxml">
            <title>Deployment Descriptor</title>

            <para>
                You need to use the special
                <classname>TouchKitApplicationServlet</classname> class instead of the
                regular <classname>ApplicationServlet</classname> in the
                <filename>web.xml</filename> deployment descriptor.
            </para>

            <para>
                As TouchKit comes with a custom widget set, you need to define a combining
                widget set for your project. The combining widget set descriptor is
                automatically generated by the Vaadin Plugin for Eclipse and in Maven when
                you install or define the TouchKit add-on.

                <!-- TODO: Reference to the add-on installation. -->
            </para>

            <programlisting><?pocket-size 65% ?>&lt;servlet&gt;
  &lt;servlet-name&gt;Vaadin Application Servlet&lt;/servlet-name&gt;
  &lt;servlet-class&gt;com.vaadin.addons.touchkit.server.TouchKitApplicationServlet&lt;/servlet-class&gt;
  &lt;init-param&gt;
    &lt;description&gt;Vaadin application class to start&lt;/description&gt;
    &lt;param-name&gt;application&lt;/param-name&gt;
    &lt;param-value&gt;<emphasis role="bold">com.vaadin.demo.mobilemail.MobileMailApplication</emphasis>&lt;/param-value&gt;
  &lt;/init-param&gt;
  &lt;init-param&gt;
    &lt;param-name&gt;widgetset&lt;/param-name&gt;
    &lt;param-value&gt;<emphasis role="bold">com.vaadin.demo.mobilemail.gwt.MobileMailWidgetSet</emphasis>&lt;/param-value&gt;
  &lt;/init-param&gt;
&lt;/servlet&gt;</programlisting>
        </section>
        
    </section>

    <section xml:id="mobile.project.application">
        <title>Application</title>

        <para>
            Mobile applications must extend the <classname>TouchKitApplication</classname>
            instead of the regular <classname>Application</classname> class. Because much
            of the browser information is not yet available when the
            <methodname>init()</methodname> method is called, you should only set basic
            things like the theme there.
        </para>

        <programlisting><?pocket-size 65% ?><![CDATA[public class MobileMailApplication extends TouchKitApplication {
    @Override
    public void init() {
        super.init();

        // Using mobile mail theme
        setTheme("mobilemail");
    }]]></programlisting>

        <para>
            Most initialization has to be be done in
            <methodname>onBrowserDetailsReady()</methodname>, including the decision to
            use a regular or a mobile browser interface. The decision is usually made
            using the user-agent information available in the
            <classname>WebBrowser</classname> class and the width and height of the main
            window.
        </para>

        <programlisting><?pocket-size 65% ?><![CDATA[public void onBrowserDetailsReady() {
    WebBrowser browser = getBrowser();
    float viewPortWidth = getMainWindow().getWidth();
    boolean isTouchDevice = browser.isTouchDevice();

    if (!isTouchDevice) {
        getMainWindow().showNotification(
            "You appear to be running on a desktop software or "+
            "other non touch device. This means trouble.");
    }

    if (viewPortWidth < 600) {
        getMainWindow().setContent(new SmartphoneMainView());
    } else {
        getMainWindow().setContent(new TabletMainView());
    }
}]]></programlisting>

        <para>
            The demo application doesn't actually support regular browsers, just notifies
            about the situation. The special mobile components in TouchKit are not
            guaranteed to work at all in regular browsers. It does give separate user
            interfaces for phones and tablets, as described in detail later.
        </para>
        
    </section>

    <section xml:id="mobile.project.x">
        <title></title>
    </section>

</section>

<!-- Keep this comment at the end of the file
Local variables:
mode: xml
sgml-omittag:nil
sgml-shorttag:nil
sgml-namecase-general:nil
sgml-general-insert-case:lower
sgml-minimize-attributes:nil
sgml-always-quote-attributes:t
sgml-indent-step:4
sgml-indent-data:t
sgml-parent-document:nil
sgml-exposed-tags:nil
sgml-local-catalogs:("/etc/sgml/catalog" "/usr/share/xemacs21/xemacs-packages/etc/psgml-dtds/CATALOG")
sgml-local-ecat-files:("ECAT" "~/sgml/ECAT" "/usr/share/sgml/ECAT" "/usr/local/share/sgml/ECAT" "/usr/local/lib/sgml/ECAT")
End:
-->
